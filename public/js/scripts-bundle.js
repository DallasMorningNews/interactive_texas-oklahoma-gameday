$(document).ready(function(){function t(t,e){if(isNaN(t)===!0||isNaN(e)===!0)return alert("Please enter a valid score for both teams"),!1;if(0===t.length||0===e.length)return alert("Please enter a score for both teams"),!1;var o={horns:t,sooners:e};$.post("http://apps.dallasnews.com/livewire/texou-picks-2016",o,function(){console.log("Success!"),n()}).fail(function(){console.log("Whoops, something bad happened!")}),$("#userForm").addClass("noShow"),$("#response").removeClass("noShow")}function e(t,e){t>e?($(".userScore").text(t+"-"+e),$(".userTeam").text("Longhorns")):e>t&&($(".userScore").text(e+"-"+t),$(".userTeam").text("Sooners"))}function o(t,e){var o,r="http%3A%2F%2Finteractives.dallasnews.com%2F2016%2Ftexas-oklahoma-gameday";o=t>=e?"My UT-OU prediction: Longhorns "+t+", Sooners "+e+". Make your pick now.":"My UT-OU prediction: Sooners "+e+", Longhorns "+t+". Make your pick now.",$("#faceShare").click(function(){FB.ui({method:"feed",name:"Texas-Oklahoma Gameday: You make the call",link:storyURL,caption:"",picture:storyIMG,description:o})}),$("#twitterShare").click(function(){window.open("https://www.twitter.com/intent/tweet?&hashtags=&text="+o+"&via=dallasnews&url="+r+"&image="+storyIMG,"top=200, left=200,width=550,height=420")})}function r(t){var e,o,r,n=t.length,s=0,a=0,c=0,i=0;$.each(t,function(t,e){e.hornsscore>e.soonersscore?(s++,c+=e.hornsscore-e.soonersscore,console.log(s,c)):e.soonersscore>e.hornsscore&&(a++,i+=e.soonersscore-e.hornsscore)}),e=s>=a?"Longhorns":"Sooners",o="Longhorns"===e?s/n*100:a/n*100,o=Math.round(10*o)/10,r="Longhorns"===e?Math.round(c/s*10)/10:Math.round(i/a*10)/10,$(".predictPercentage").text(o+"%"),$(".predictTeam").text(e),$(".predictPoints").text(r)}function n(){p=[],u=[],h="",d="",$("#chart").html(""),$.getJSON("http://apps.dallasnews.com/livewire/texou-picks-2016").done(function(t){var e=[];$.each(t,function(t,o){o.hornsscore<80&&o.soonersscore<80&&o.hornsscore!==o.soonersscore&&e.push(o)}),s(e),r(e)})}function s(t){t.forEach(function(t){var e=[];e.push(t.hornsscore),e.push(t.soonersscore),p.push(e)}),h=_.countBy(p);var e=_.sortBy(h).reverse();d=e[0],_.forOwn(h,function(t,e){var o=e.split(","),r=[];r.push(parseInt(o[0])),r.push(parseInt(o[1])),u.push(r)}),a(u)}function a(t){console.log(t);var e={top:10,right:10,bottom:50,left:50},o=$("#chart").width()-e.left-e.right,r=$("#chart").width()-e.top-e.bottom,n=(o-e.left-e.right)/2,s=d3.max(t,function(t){return t[0]}),a=d3.max(t,function(t){return t[1]}),i=0;i=s>a?s:a;var l=d3.scaleLinear().range([0,o]).domain([0,i]),p=d3.scaleLinear().range([r,0]).domain([0,i]),u=d3.axisBottom(l).ticks(10).tickSize(-r),f=d3.axisLeft(p).ticks(10*r/o).tickSize(-o),m=d3.select("#chart").append("svg").attr("width",o+e.left+e.right).attr("height",r+e.top+e.bottom).append("g").attr("transform","translate("+e.left+","+e.top+")");m.append("g").attr("class","x axis ").attr("id","axis--x").attr("transform","translate(0,"+r+")").call(u),m.append("g").attr("class","y axis").attr("id","axis--y").call(f);var g=d3.scaleLinear().range([5,20]).domain([1,d]);m.selectAll(".dot").data(t).enter().append("circle").attr("class","dot").attr("r",function(t){var e=h[t[0]+","+t[1]];return g(parseInt(e))}).attr("cx",function(t){return console.log(parseInt(t[0])),l(parseInt(t[0]))}).attr("cy",function(t){return console.log(parseInt(t[1])),p(parseInt(t[1]))}).attr("opacity",".6").attr("class",function(t){return t[0]>t[1]?"horns-color":"sooners-color"}).on("mouseenter",function(t){var o=h[t[0]+","+t[1]],r=d3.mouse(this)[0],s=d3.mouse(this)[1];c(r,s,n,e),d3.select(".hornsTipScore").text(t[0]),d3.select(".soonersTipScore").text(t[1]),d3.select(".tipPredict").text(o)}).on("mouseleave",function(){d3.select("#tooltip").classed("noShow",!0)}),d3.selectAll("circle").each(function(t){var e=parseInt(d3.select(this).attr("r"));e<10&&this.parentElement.appendChild(this)}),m.append("line").attr("x1",r).attr("y1",0).attr("x2",0).attr("y2",r).attr("stroke-width",2).attr("class","diagonal").attr("stroke","#329ce8"),m.append("text").attr("text-anchor","middle").attr("x",o/2*-1).attr("y",-25).attr("transform","rotate(-90)").attr("class","team-name").text("Sooners’ score"),m.append("text").attr("text-anchor","middle").attr("y",o+30).attr("x",o/2).attr("class","team-name").text("Longhorns’ score")}function c(t,e,o,r){tooltipWidth=180,$(window).width()<=600&&(tooltipWidth=120),d3.select("#tooltip").classed("noShow",!1).style("left",function(e){var n=t<=o?t+r.left+20+"px":t+r.left-(tooltipWidth+20)+"px";return n}).style("top",e+"px")}var i=new Date,l=i.getFullYear();$(".copyright").text(l);var h,d,p=[],u=[];$("#submit").click(function(){hornsScore=$("#hornsScore").val(),soonersScore=$("#soonersScore").val(),console.log(hornsScore,soonersScore),t(hornsScore,soonersScore),e(hornsScore,soonersScore),o(hornsScore,soonersScore)}),n();var f=$("#chartBlock").width();$("#chartBlock").css("min-height",f)});
//# sourceMappingURL=scripts-bundle.js.map
